import{b as x,r as u,j as e,c as j,B as h,d as g}from"./index-ewAQYAo0.js";import{u as f,c as N,a as v,b as y}from"./index.esm-DLu0us_N.js";import{l as w}from"./index-TjCxX7sJ.js";const b=w("https://service-provider-service-pro.onrender.com"),k=()=>{var d,t,l,a,i;const[o,{data:s}]=x();return u.useEffect(()=>(o(),b.on("admin-Profile-Update",()=>{o()}),()=>{b.off("admin-Profile-Update")}),[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container mt-5",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row align-items-center border p-3 shadow bg-info-subtle rounded border-black",children:[e.jsx("div",{className:"col-md-3 text-center",children:e.jsx("img",{src:s&&((d=s[0])!=null&&d.hero)?s[0].hero:"https://via.placeholder.com/150",alt:"Profile",className:"rounded-circle border border-black img-fluid",style:{height:"200px",width:"200px",objectFit:"cover"}})}),e.jsxs("div",{className:"col-md-7",children:[e.jsx("h4",{className:"mb-3",children:s&&((t=s[0])==null?void 0:t.name)}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Email:"})," ",s&&((l=s[0])==null?void 0:l.email)]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Mobile:"})," ",s&&((a=s[0])==null?void 0:a.mobile)]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Role:"})," ",s&&((i=s[0])==null?void 0:i.role)]})]}),e.jsx("div",{className:"col-md-2 text-center",children:e.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",className:"btn btn-primary btn-block",children:"Update Profile"})})]})})}),e.jsx(U,{})]})},U=()=>{const[o,{isSuccess:s,isError:d,error:t,isLoading:l}]=j(),a=f({initialValues:{mobile:"",hero:null},validationSchema:N({mobile:v().required("Enter mobile"),hero:y().required("Choose an image").test("fileType","Unsupported File Format",r=>r&&["image/jpeg","image/png","image/jpg"].includes(r.type))}),onSubmit:async(r,{resetForm:p})=>{const c=new FormData;c.append("mobile",r.mobile),c.append("hero",r.hero);try{await o(c).unwrap(),h.success("Profile Updated Successfully 👍"),p();const m=document.getElementById("exampleModal"),n=window.bootstrap.Modal.getInstance(m);n==null||n.hide()}catch{h.error("Update failed. Please try again.")}}}),i=r=>g("form-control",{"is-valid":!a.errors[r]&&a.touched[r],"is-invalid":a.errors[r]&&a.touched[r]});return e.jsx("div",{className:"modal fade",id:"exampleModal",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"exampleModalLabel",children:"Update Profile 👇"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("form",{onSubmit:a.handleSubmit,noValidate:!0,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-6 my-2",children:[e.jsx("input",{type:"text",placeholder:"Enter Mobile",className:i("mobile"),...a.getFieldProps("mobile")}),a.touched.mobile&&a.errors.mobile&&e.jsx("div",{className:"invalid-feedback",children:a.errors.mobile})]}),e.jsxs("div",{className:"col-sm-6 my-2",children:[e.jsx("input",{type:"file",accept:"image/*",className:i("hero"),onChange:r=>a.setFieldValue("hero",r.currentTarget.files[0])}),a.touched.hero&&a.errors.hero&&e.jsx("div",{className:"invalid-feedback",children:a.errors.hero})]}),e.jsx("div",{className:"col-12 mt-3",children:e.jsx("button",{type:"submit",className:"btn btn-outline-warning w-100",disabled:l,children:l?"Updating...":"Update"})})]})})})]})})})};export{k as default};
